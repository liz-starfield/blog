<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.0" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.13" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="alternate" hreflang="en-us" href="https://liz-in-tech.github.io/blog/posts/llm/027_distribution_and_parallelism_3.html"><meta property="og:url" content="https://liz-in-tech.github.io/blog/zh/posts/llm/027_distribution_and_parallelism_3.html"><meta property="og:site_name" content="Liz"><meta property="og:title" content="åˆ†å¸ƒå¼è®­ç»ƒä¹‹å››ï¼šå¹¶è¡Œç­–ç•¥"><meta property="og:description" content="åˆ†å¸ƒå¼è®­ç»ƒä¹‹å››ï¼šå¹¶è¡Œç­–ç•¥"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:locale:alternate" content="en-US"><meta property="og:updated_time" content="2025-03-08T14:32:06.000Z"><meta property="article:author" content="Liz"><meta property="article:tag" content="åˆ†å¸ƒå¼"><meta property="article:tag" content="å¹¶è¡Œ"><meta property="article:published_time" content="2025-03-04T00:00:00.000Z"><meta property="article:modified_time" content="2025-03-08T14:32:06.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"åˆ†å¸ƒå¼è®­ç»ƒä¹‹å››ï¼šå¹¶è¡Œç­–ç•¥","image":[""],"datePublished":"2025-03-04T00:00:00.000Z","dateModified":"2025-03-08T14:32:06.000Z","author":[{"@type":"Person","name":"Liz","url":"https://github.com/liz-in-tech"}]}</script><link rel="icon" herf="/blogger.png"><link rel="icon" href="/blog/blogger.png"><title>åˆ†å¸ƒå¼è®­ç»ƒä¹‹å››ï¼šå¹¶è¡Œç­–ç•¥ | Liz</title><meta name="description" content="åˆ†å¸ƒå¼è®­ç»ƒä¹‹å››ï¼šå¹¶è¡Œç­–ç•¥">
    <link rel="preload" href="/blog/assets/style-m_obra2h.css" as="style"><link rel="stylesheet" href="/blog/assets/style-m_obra2h.css">
    <link rel="modulepreload" href="/blog/assets/app-74fYY7Rf.js"><link rel="modulepreload" href="/blog/assets/027_distribution_and_parallelism_3.html-5kFJGreK.js"><link rel="modulepreload" href="/blog/assets/027_distribution_and_parallelism_3.html-77Cvv0oS.js"><link rel="modulepreload" href="/blog/assets/027_ep2-bnsUQED8.js"><link rel="modulepreload" href="/blog/assets/plugin-vue_export-helper-x3n3nnut.js">
    <link rel="prefetch" href="/blog/assets/index.html-YbPtte5_.js" as="script"><link rel="prefetch" href="/blog/assets/intro.html-CGfhr1vY.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-FUMOuem4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html--TTjrkIy.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-g4Nfr7z1.js" as="script"><link rel="prefetch" href="/blog/assets/intro.html-bitGHKd2.js" as="script"><link rel="prefetch" href="/blog/assets/001_langchain.html-nrisQopy.js" as="script"><link rel="prefetch" href="/blog/assets/002_langchain_sourcecode.html-9XtwFAwc.js" as="script"><link rel="prefetch" href="/blog/assets/003_streamlit.html-oji9upQP.js" as="script"><link rel="prefetch" href="/blog/assets/004_transformer.html-xrin91s2.js" as="script"><link rel="prefetch" href="/blog/assets/005_llama.html-q7LEGqjL.js" as="script"><link rel="prefetch" href="/blog/assets/006_llm_leaderboard.html-c628DmZb.js" as="script"><link rel="prefetch" href="/blog/assets/007_computer_use.html-4RcS3hxb.js" as="script"><link rel="prefetch" href="/blog/assets/008_rag_challenge.html-_8stdYVV.js" as="script"><link rel="prefetch" href="/blog/assets/009_llm_challenge.html-eluz3bTT.js" as="script"><link rel="prefetch" href="/blog/assets/010_rag_workflow.html-Ft0RQWf3.js" as="script"><link rel="prefetch" href="/blog/assets/011_vector_database.html-CImz0KSx.js" as="script"><link rel="prefetch" href="/blog/assets/012_prompt_engineering.html-1CqW55t5.js" as="script"><link rel="prefetch" href="/blog/assets/013_optimizing_llm.html-6CxOIR84.js" as="script"><link rel="prefetch" href="/blog/assets/014_rag_evaluation.html-l_kCYUI1.js" as="script"><link rel="prefetch" href="/blog/assets/015_fine_tune.html-JrbwEhT3.js" as="script"><link rel="prefetch" href="/blog/assets/016_multimodal.html-XtD4OMNh.js" as="script"><link rel="prefetch" href="/blog/assets/017_agent_and_multiagent.html-dm178NRn.js" as="script"><link rel="prefetch" href="/blog/assets/018_huggingface.html-7ujiqdYY.js" as="script"><link rel="prefetch" href="/blog/assets/019_ollama.html-kLkdC4dl.js" as="script"><link rel="prefetch" href="/blog/assets/020_neo4j.html-61m3-6IM.js" as="script"><link rel="prefetch" href="/blog/assets/021_microsoft_graphrag.html-0d0frUhq.js" as="script"><link rel="prefetch" href="/blog/assets/022_llamaindex_graphrag.html-FazlUPBT.js" as="script"><link rel="prefetch" href="/blog/assets/023_agent_framework.html-5MCDM_Sd.js" as="script"><link rel="prefetch" href="/blog/assets/024_distribution_and_parallelism.html-uCefT9T7.js" as="script"><link rel="prefetch" href="/blog/assets/025_distribution_and_parallelism_1.html-32IzAErP.js" as="script"><link rel="prefetch" href="/blog/assets/026_distribution_and_parallelism_2.html-MEZ1JY2b.js" as="script"><link rel="prefetch" href="/blog/assets/027_distribution_and_parallelism_3.html-IYByZhbZ.js" as="script"><link rel="prefetch" href="/blog/assets/028_distribution_and_parallelism_4.html-Kub1JEXd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ZDCSnlc1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ZYw6WxxA.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-OavE9BET.js" as="script"><link rel="prefetch" href="/blog/assets/001_langchain.html-hE_T0u_5.js" as="script"><link rel="prefetch" href="/blog/assets/002_langchain_sourcecode.html-iH0mq6XB.js" as="script"><link rel="prefetch" href="/blog/assets/003_streamlit.html-WyFhRqF6.js" as="script"><link rel="prefetch" href="/blog/assets/004_transformer.html-YaT0PR6o.js" as="script"><link rel="prefetch" href="/blog/assets/005_llama.html-x2qtCXhJ.js" as="script"><link rel="prefetch" href="/blog/assets/006_llm_leaderboard.html-WHPR-17-.js" as="script"><link rel="prefetch" href="/blog/assets/007_computer_use.html-hz6Q-DAA.js" as="script"><link rel="prefetch" href="/blog/assets/008_rag_challenge.html-3KMCwhrh.js" as="script"><link rel="prefetch" href="/blog/assets/009_llm_challenge.html-7gxKMp_3.js" as="script"><link rel="prefetch" href="/blog/assets/010_rag_workflow.html-KndRvZAj.js" as="script"><link rel="prefetch" href="/blog/assets/011_vector_database.html-Akmj-Ub_.js" as="script"><link rel="prefetch" href="/blog/assets/012_prompt_engineering.html-bXz0YlpJ.js" as="script"><link rel="prefetch" href="/blog/assets/013_optimizing_llm.html-W-CdR_ck.js" as="script"><link rel="prefetch" href="/blog/assets/014_rag_evaluation.html-aq7YkQ-T.js" as="script"><link rel="prefetch" href="/blog/assets/015_fine_tune.html-V8hUrR0F.js" as="script"><link rel="prefetch" href="/blog/assets/016_multimodal.html-DCPUUxWe.js" as="script"><link rel="prefetch" href="/blog/assets/017_agent_and_multiagent.html-RlA7g4kG.js" as="script"><link rel="prefetch" href="/blog/assets/018_huggingface.html-YkW8PRbE.js" as="script"><link rel="prefetch" href="/blog/assets/019_ollama.html-V5tcXCC4.js" as="script"><link rel="prefetch" href="/blog/assets/020_neo4j.html-qFyQHNwt.js" as="script"><link rel="prefetch" href="/blog/assets/021_microsoft_graphrag.html-kvlLpO3f.js" as="script"><link rel="prefetch" href="/blog/assets/022_llamaindex_graphrag.html-AiRwjg9s.js" as="script"><link rel="prefetch" href="/blog/assets/023_agent_framework.html-VZsN2kO8.js" as="script"><link rel="prefetch" href="/blog/assets/024_distribution_and_parallelism.html-MO4kg9bC.js" as="script"><link rel="prefetch" href="/blog/assets/025_distribution_and_parallelism_1.html-ZR9kuXUl.js" as="script"><link rel="prefetch" href="/blog/assets/026_distribution_and_parallelism_2.html-GkjDPoeT.js" as="script"><link rel="prefetch" href="/blog/assets/028_distribution_and_parallelism_4.html-38Gbieji.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-wh_dBtOR.js" as="script"><link rel="prefetch" href="/blog/assets/404.html-cxLWDy2T.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-kf4JCRaf.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-RkA-insV.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-4kI_oqSd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-WhuidxNt.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-OqGkeUA_.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5GeN-sdD.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c4Rf4yh1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2r0jUs7o.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BSKRXRQc.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-KjTsJ0Hg.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-TteIwMx3.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-g00XXzrL.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-YxbJgo4L.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3T79Cy0i.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-A5tlQHan.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-04ff5e0O.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-vgZ6rfFh.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-OmipPplE.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-E1KrJL6a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-oPH9QkTj.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-cHRqZSs8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-74SU9ZTn.js" as="script"><link rel="prefetch" href="/blog/assets/index.html--iJiA8oX.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-oZPWb_Fc.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-FUIWSLsp.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5ERWyusD.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Zjn0JNqd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-jcvPTrgB.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9t2TsyuQ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CcLVFNIv.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DVoYOOaL.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-V52ipvRm.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9If_KW0o.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-df9Mrf2R.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f9bWoKcO.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-GYH0QUoo.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-JVTfeijx.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-_C1QVNqX.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-L_IXFmna.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-nZWHmXY7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-x4gPgqE4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-bWnVyuyA.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-LHukpLS7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-howjHe2f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DeN_iOWx.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-cnlzR0a7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0P_c_pcU.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-dy_CcFmq.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-FzFytZ_p.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2KSwV7xp.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-F1coElwg.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ffflqCb9.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-F8ZuLYgH.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-HeYWaFeL.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-xKYeJEc5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-xB-iS7Ql.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-OEUPqfTV.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-EE4iQI9m.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-g1PUF_BG.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-nUBcs85a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9Y3la5Sf.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-wufIFDPM.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-bXZQIxRE.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-wd6ZkEHi.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Xlk0AXmC.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Uv7c7pYa.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-FfZqC9tZ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-mSPhZxqB.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-51HoKD5A.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Q5_K6Vux.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-jkWPo860.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-kTEqch5G.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-y4iBqBqc.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-iETYQT4k.js" as="script"><link rel="prefetch" href="/blog/assets/intro.html-ule1Jz9M.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-B26Ce-6E.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-JMfyTDfh.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-GNSVMZPS.js" as="script"><link rel="prefetch" href="/blog/assets/intro.html-XiFX24l6.js" as="script"><link rel="prefetch" href="/blog/assets/001_langchain.html-aTUuNcf0.js" as="script"><link rel="prefetch" href="/blog/assets/002_langchain_sourcecode.html-F-G_LZNv.js" as="script"><link rel="prefetch" href="/blog/assets/003_streamlit.html-1wjML3Lp.js" as="script"><link rel="prefetch" href="/blog/assets/004_transformer.html--z2TABMK.js" as="script"><link rel="prefetch" href="/blog/assets/005_llama.html-qJgD5cA8.js" as="script"><link rel="prefetch" href="/blog/assets/006_llm_leaderboard.html-MyTGH7ZD.js" as="script"><link rel="prefetch" href="/blog/assets/007_computer_use.html-R276mg6X.js" as="script"><link rel="prefetch" href="/blog/assets/008_rag_challenge.html-FggHTkut.js" as="script"><link rel="prefetch" href="/blog/assets/009_llm_challenge.html-vQmkuCAd.js" as="script"><link rel="prefetch" href="/blog/assets/010_rag_workflow.html-uw8sfEbw.js" as="script"><link rel="prefetch" href="/blog/assets/011_vector_database.html-njw3HA-K.js" as="script"><link rel="prefetch" href="/blog/assets/012_prompt_engineering.html-YZl8_3DJ.js" as="script"><link rel="prefetch" href="/blog/assets/013_optimizing_llm.html-0KGQiBPr.js" as="script"><link rel="prefetch" href="/blog/assets/014_rag_evaluation.html-ZE5Abz_N.js" as="script"><link rel="prefetch" href="/blog/assets/015_fine_tune.html-N7MDUyd-.js" as="script"><link rel="prefetch" href="/blog/assets/016_multimodal.html-tY4Lrou5.js" as="script"><link rel="prefetch" href="/blog/assets/017_agent_and_multiagent.html-LLZQoHT_.js" as="script"><link rel="prefetch" href="/blog/assets/018_huggingface.html-vlUjdk6y.js" as="script"><link rel="prefetch" href="/blog/assets/019_ollama.html-0E1a8ymD.js" as="script"><link rel="prefetch" href="/blog/assets/020_neo4j.html-VDOBSpBs.js" as="script"><link rel="prefetch" href="/blog/assets/021_microsoft_graphrag.html-NhowT-zb.js" as="script"><link rel="prefetch" href="/blog/assets/022_llamaindex_graphrag.html-m1QqxyaQ.js" as="script"><link rel="prefetch" href="/blog/assets/023_agent_framework.html-s6aaQyPq.js" as="script"><link rel="prefetch" href="/blog/assets/024_distribution_and_parallelism.html-mcWDVxU9.js" as="script"><link rel="prefetch" href="/blog/assets/025_distribution_and_parallelism_1.html-3Q1VNe84.js" as="script"><link rel="prefetch" href="/blog/assets/026_distribution_and_parallelism_2.html-plxA0Vv1.js" as="script"><link rel="prefetch" href="/blog/assets/027_distribution_and_parallelism_3.html-Djdzmvel.js" as="script"><link rel="prefetch" href="/blog/assets/028_distribution_and_parallelism_4.html-ZyvwGllI.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-MMIbGt8W.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Meezp5An.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-LHTTg6UW.js" as="script"><link rel="prefetch" href="/blog/assets/001_langchain.html--LyYB64w.js" as="script"><link rel="prefetch" href="/blog/assets/002_langchain_sourcecode.html-iQVqBKNY.js" as="script"><link rel="prefetch" href="/blog/assets/003_streamlit.html-53ADn2wT.js" as="script"><link rel="prefetch" href="/blog/assets/004_transformer.html-97ovvest.js" as="script"><link rel="prefetch" href="/blog/assets/005_llama.html-YceYqKyv.js" as="script"><link rel="prefetch" href="/blog/assets/006_llm_leaderboard.html-6bgRRWw9.js" as="script"><link rel="prefetch" href="/blog/assets/007_computer_use.html-vouBuA9W.js" as="script"><link rel="prefetch" href="/blog/assets/008_rag_challenge.html-km78igxp.js" as="script"><link rel="prefetch" href="/blog/assets/009_llm_challenge.html-SQpsJNVu.js" as="script"><link rel="prefetch" href="/blog/assets/010_rag_workflow.html-gx3_TnZU.js" as="script"><link rel="prefetch" href="/blog/assets/011_vector_database.html-ZDe65xaT.js" as="script"><link rel="prefetch" href="/blog/assets/012_prompt_engineering.html-KiDWLV83.js" as="script"><link rel="prefetch" href="/blog/assets/013_optimizing_llm.html-qZETJJKw.js" as="script"><link rel="prefetch" href="/blog/assets/014_rag_evaluation.html-vvS2fOQT.js" as="script"><link rel="prefetch" href="/blog/assets/015_fine_tune.html--pvIAqdI.js" as="script"><link rel="prefetch" href="/blog/assets/016_multimodal.html-1Ysa9iba.js" as="script"><link rel="prefetch" href="/blog/assets/017_agent_and_multiagent.html-oMffmvvX.js" as="script"><link rel="prefetch" href="/blog/assets/018_huggingface.html-iKSVOJFV.js" as="script"><link rel="prefetch" href="/blog/assets/019_ollama.html-yVAuISKR.js" as="script"><link rel="prefetch" href="/blog/assets/020_neo4j.html-vk88Pa0d.js" as="script"><link rel="prefetch" href="/blog/assets/021_microsoft_graphrag.html-L5FlOwpQ.js" as="script"><link rel="prefetch" href="/blog/assets/022_llamaindex_graphrag.html-xRgh74ep.js" as="script"><link rel="prefetch" href="/blog/assets/023_agent_framework.html-747Xrf6v.js" as="script"><link rel="prefetch" href="/blog/assets/024_distribution_and_parallelism.html-IbLXEclX.js" as="script"><link rel="prefetch" href="/blog/assets/025_distribution_and_parallelism_1.html-dAavkjtv.js" as="script"><link rel="prefetch" href="/blog/assets/026_distribution_and_parallelism_2.html-Oarj2nhk.js" as="script"><link rel="prefetch" href="/blog/assets/028_distribution_and_parallelism_4.html-PBsY_rap.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Zcp-eU4_.js" as="script"><link rel="prefetch" href="/blog/assets/404.html-rkj_7lo2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-QLwL-7Ep.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Oxf_ebnS.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5D2IjCOg.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-A31xeYwf.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-msPfzzJg.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DZdGhB_L.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-boE_F-iQ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-h_NjiMfU.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-p2Tsu2p1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-_xON_iJC.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-B2Pkj6YQ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-W452oCoL.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-TmPJxG-7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-V70cqVcH.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-B_T6Dw-T.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-dPdCaTCj.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-A2W7lKnn.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-j29Sywkd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-1H13OqYN.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0J9j5_9y.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-6XaTVS8A.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0XfA9SW_.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-tAjPVsUY.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-IHCZ1ifx.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-_hyrX4u7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-cyiudMuz.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9hZ2W15j.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5UYirEbR.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-YEuUpom_.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-QgDkvTJo.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-27VGLSN_.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-m7x4n_H9.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-vZ2L26cY.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-TFKHFmGv.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-bOiN38kD.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-JVCXdH3X.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-11ZIgyrs.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3m_mRo18.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-tzLGsnDk.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-IxMKj7wS.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-mYApoqog.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-OmzkmQ32.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-nWtmao90.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-xZKfuCLl.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-WqiXb0WV.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-w71sLuGm.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-GtICBxns.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BnLb2pp-.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-l_HMqEsW.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-4ecOk4nY.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-r9SC3-tn.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Z6k6LLnw.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Knbb-9ji.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5x90Xd-z.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2bCBwEM1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-kq0jp3Og.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-XbG0eQrg.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DDni3m4T.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Kfam6HkQ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-tLjhI3cT.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-dgJiYNze.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-mLruQIuy.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Gk8Wyjk0.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-8GIfW0mp.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-zzlJAm82.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-gQrm5__9.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BflITUVW.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Sps6mSh5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ZrPf0SHj.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Das9heZJ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-mcwfHmXR.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-jyaziJXl.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-UmpcJspg.js" as="script"><link rel="prefetch" href="/blog/assets/photoswipe.esm-08_zHRDQ.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container no-sidebar has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/blog/zh/"><img class="vp-nav-logo" src="/blog/blogger.png" alt><!----><span class="vp-site-name hide-in-pad">Liz</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="é¦–é¡µ" class="vp-link nav-link nav-link" href="/blog/zh/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>é¦–é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="é¡¹ç›®" class="vp-link nav-link nav-link" href="/blog/zh/demo/"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span>é¡¹ç›®<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><div class="nav-item"><div class="dropdown-wrapper i18n-dropdown"><button type="button" class="dropdown-title" aria-label="é€‰æ‹©è¯­è¨€"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-label="English" class="vp-link nav-link nav-link" href="/blog/posts/llm/027_distribution_and_parallelism_3.html"><!---->English<!----></a></li><li class="dropdown-item"><a aria-label="ç®€ä½“ä¸­æ–‡" class="vp-link nav-link active nav-link active" href="/blog/zh/posts/llm/027_distribution_and_parallelism_3.html"><!---->ç®€ä½“ä¸­æ–‡<!----></a></li></ul></button></div></div><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/liz-in-tech" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><form class="search-box" role="search"><input type="search" placeholder="æœç´¢" autocomplete="off" spellcheck="false" value><!----></form><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fa-fw fa-sm fas fa-lightbulb" style=""></span>åˆ†å¸ƒå¼è®­ç»ƒä¹‹å››ï¼šå¹¶è¡Œç­–ç•¥</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/liz-in-tech" target="_blank" rel="noopener noreferrer">Liz</a></span><span property="author" content="Liz"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2025-03-04T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 12 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT12M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category6 clickable" role="navigation">LLM</span><!--]--><meta property="articleSection" content="LLM"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item tag4 clickable" role="navigation">åˆ†å¸ƒå¼</span><span class="page-tag-item tag3 clickable" role="navigation">å¹¶è¡Œ</span><!--]--><meta property="keywords" content="åˆ†å¸ƒå¼,å¹¶è¡Œ"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_1-äº”ä¸ªç»´åº¦çš„å¹¶è¡Œç­–ç•¥-5d-parallelization-strategies">1. äº”ä¸ªç»´åº¦çš„å¹¶è¡Œç­–ç•¥ 5D Parallelization Strategies</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_1-1-äº”ä¸ªç»´åº¦">1.1. äº”ä¸ªç»´åº¦</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_1-2-å¤šä¸ªå¹¶è¡Œç­–ç•¥çš„ç»“åˆ">1.2. å¤šä¸ªå¹¶è¡Œç­–ç•¥çš„ç»“åˆ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_1-3-å½±å“èŒƒå›´">1.3. å½±å“èŒƒå›´</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_1-4-pp-vs-zero-3">1.4. PP vs ZeRO-3</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_1-5-tp-sp-vs-cp-vs-ep">1.5. TP &amp; SP vs CP vs EP</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_1-6-æ¯ç§å¹¶è¡Œç­–ç•¥èŠ‚çº¦å†…å­˜çš„å¯¹æ¯”">1.6. æ¯ç§å¹¶è¡Œç­–ç•¥èŠ‚çº¦å†…å­˜çš„å¯¹æ¯”</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_2-æœ€ä½³è®­ç»ƒé…ç½®">2. æœ€ä½³è®­ç»ƒé…ç½®</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_2-1-step1-fitting-a-training-step-in-memory-fit-a-full-model-instance-on-our-gpus">2.1. Step1: Fitting a Training Step in Memory / Fit a full model instance on our GPUs</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_2-2-step2-achieving-target-global-batch-size">2.2. Step2: Achieving Target Global Batch Size</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_2-3-step3-optimizing-training-throughput-make-sure-the-training-is-running-as-fast-as-possible">2.3. Step3: Optimizing Training Throughput / make sure the training is running as fast as possible</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_2-4-top-configurations">2.4. Top Configurations</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_3-å¼ é‡å¹¶è¡Œ-tensor-parallelism-tp">3. å¼ é‡å¹¶è¡Œ Tensor Parallelismï¼ˆTPï¼‰</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_3-1-tpåŸç†">3.1. TPåŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_3-2-transformerå—çš„tpåº”ç”¨">3.2. Transformerå—çš„TPåº”ç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_3-3-ç¼©æ”¾tpåˆ†ç‰‡å¤§å°å¯¹ååé‡å’Œå†…å­˜çš„å½±å“">3.3. ç¼©æ”¾TPåˆ†ç‰‡å¤§å°å¯¹ååé‡å’Œå†…å­˜çš„å½±å“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_4-åºåˆ—å¹¶è¡Œ-sequence-parallelism-sp">4. åºåˆ—å¹¶è¡Œ Sequence Parallelism (SP)</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_4-1-tp-only-ä¸-tp-with-sp">4.1. TP Only ä¸ TP with SP</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_4-2-ååé‡å’Œå†…å­˜å ç”¨">4.2. ååé‡å’Œå†…å­˜å ç”¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_5-context-parallelism-cp">5. Context Parallelism (CP)</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_5-1-ring-attention-ç¯å½¢æ³¨æ„åŠ›">5.1. Ring Attention ç¯å½¢æ³¨æ„åŠ›</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_5-2-zig-zag-ring-attention">5.2. Zig-Zag Ring Attention</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_6-æµæ°´çº¿å¹¶è¡Œ-pipeline-parallelism-pp">6. æµæ°´çº¿å¹¶è¡Œ Pipeline Parallelism (PP)</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_6-1-å†…å­˜å ç”¨">6.1. å†…å­˜å ç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_6-2-ä¸»è¦æŒ‘æˆ˜-å°½é‡é¿å…gpuè®¡ç®—çš„é—²ç½®-æé«˜gpuåˆ©ç”¨ç‡">6.2. ä¸»è¦æŒ‘æˆ˜ï¼šå°½é‡é¿å…GPUè®¡ç®—çš„é—²ç½®ï¼Œæé«˜GPUåˆ©ç”¨ç‡</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_6-3-æœ´ç´ pp">6.3. æœ´ç´ PP</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_6-4-all-forward-all-backward-afab-æ–¹æ¡ˆ-forward-then-backword-f-then-b">6.4. all-forward-all-backward (AFAB) æ–¹æ¡ˆ / forward then backword / F then B</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_6-5-one-forward-one-backward-1f1b-and-llama-3-1-schemes-æ–¹æ¡ˆ">6.5. One-forward-one-backward (1F1B)  and LLama 3.1 schemes æ–¹æ¡ˆ</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_7-expert-parallelism-ep">7. Expert Parallelism (EP)</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h1 id="åˆ†å¸ƒå¼è®­ç»ƒä¹‹å››-å¹¶è¡Œç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#åˆ†å¸ƒå¼è®­ç»ƒä¹‹å››-å¹¶è¡Œç­–ç•¥" aria-hidden="true">#</a> åˆ†å¸ƒå¼è®­ç»ƒä¹‹å››ï¼šå¹¶è¡Œç­–ç•¥</h1><!-- more --><h2 id="_1-äº”ä¸ªç»´åº¦çš„å¹¶è¡Œç­–ç•¥-5d-parallelization-strategies" tabindex="-1"><a class="header-anchor" href="#_1-äº”ä¸ªç»´åº¦çš„å¹¶è¡Œç­–ç•¥-5d-parallelization-strategies" aria-hidden="true">#</a> 1. äº”ä¸ªç»´åº¦çš„å¹¶è¡Œç­–ç•¥ 5D Parallelization Strategies</h2><h3 id="_1-1-äº”ä¸ªç»´åº¦" tabindex="-1"><a class="header-anchor" href="#_1-1-äº”ä¸ªç»´åº¦" aria-hidden="true">#</a> 1.1. äº”ä¸ªç»´åº¦</h3><ul><li>Data Parallelism (DP) -&gt; batchç»´åº¦ <ul><li>ZeRO (Zero Redundancy Optimizer) <ul><li>ZeRO-1: optimizer state åˆ†ç‰‡</li><li>ZeRO-2: optimizer state + gradient åˆ†ç‰‡</li><li>ZeRO-3 / FSDP (Fully-Sharded Data Parallelism): optimizer state + gradient + parameter åˆ†ç‰‡</li></ul></li></ul></li><li>Tensor Parallelism (TP) -&gt; hidden_stateç»´åº¦</li><li>Sequence Parallelism (SP) -&gt; sequenceç»´åº¦</li><li>Context Parallelism (CP) -&gt; sequenceç»´åº¦</li><li>Pipeline parallelism (PP) -&gt; model_layerç»´åº¦</li><li>Expert Parallelism (PP) -&gt; model_expertç»´åº¦</li></ul><h3 id="_1-2-å¤šä¸ªå¹¶è¡Œç­–ç•¥çš„ç»“åˆ" tabindex="-1"><a class="header-anchor" href="#_1-2-å¤šä¸ªå¹¶è¡Œç­–ç•¥çš„ç»“åˆ" aria-hidden="true">#</a> 1.2. å¤šä¸ªå¹¶è¡Œç­–ç•¥çš„ç»“åˆ</h3><ul><li>PP + ZeRO-1/ZeRO-2/ZeRO-3 <ul><li>eg. the training of DeepSeek-v3 used PP combined with ZeRO-1</li></ul></li><li>TP &amp; SP + PP</li><li>TP &amp; SP + ZeRO-3</li><li>CP + EP</li><li>TP &amp; SP + CP + EP + PP + FSDP</li></ul><figure><img src="/blog/assets/027_combine_strategies-v1G8nTkV.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_1-3-å½±å“èŒƒå›´" tabindex="-1"><a class="header-anchor" href="#_1-3-å½±å“èŒƒå›´" aria-hidden="true">#</a> 1.3. å½±å“èŒƒå›´</h3><ul><li>TP &amp; SP: é€šè¿‡åˆ†ç‰‡æƒé‡å’Œæ¿€æ´»å€¼ï¼Œå½±å“æ•´ä¸ªæ¨¡å‹çš„è®¡ç®—</li><li>CP: ä¸»è¦å½±å“æ³¨æ„åŠ›å±‚ï¼Œå› ä¸ºé‚£æ˜¯éœ€è¦è·¨åºåˆ—é€šä¿¡çš„åœ°æ–¹ï¼Œè€Œå…¶ä»–å±‚åˆ™åœ¨åˆ†ç‰‡çš„åºåˆ—ä¸Šç‹¬ç«‹è¿è¡Œ</li><li>EP: ä¸»è¦å½±å“MoEå±‚ï¼ˆè¿™äº›å±‚æ›¿æ¢äº†æ ‡å‡†çš„MLPå—ï¼‰ï¼Œè€Œæ³¨æ„åŠ›å’Œå…¶ä»–ç»„ä»¶ä¿æŒä¸å˜</li><li>PP: å¹¶ä¸ç‰¹åˆ«é’ˆå¯¹ä»»ä½•å­æ¨¡å—æˆ–ç»„ä»¶</li><li>ZeRO: å¹¶ä¸ç‰¹åˆ«é’ˆå¯¹ä»»ä½•å­æ¨¡å—æˆ–ç»„ä»¶</li></ul><h3 id="_1-4-pp-vs-zero-3" tabindex="-1"><a class="header-anchor" href="#_1-4-pp-vs-zero-3" aria-hidden="true">#</a> 1.4. PP vs ZeRO-3</h3><p>å…±åŒç‚¹ï¼šéƒ½æ˜¯å°†æ¨¡å‹æƒé‡åˆ†å‰²åˆ°å¤šä¸ª GPU ä¸Šï¼Œå¹¶æ²¿ç€æ¨¡å‹æ·±åº¦è½´è¿›è¡Œé€šä¿¡å’Œè®¡ç®—çš„æ–¹æ³•ï¼Œæ¯ä¸ªè®¾å¤‡ä¸Šéƒ½ä¼šè®¡ç®—å®Œæ•´çš„å±‚æ“ä½œ</p><p>ä¸åŒç‚¹ï¼š</p><figure><img src="/blog/assets/027_pp_vs_zero3-Y5fGKK90.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_1-5-tp-sp-vs-cp-vs-ep" tabindex="-1"><a class="header-anchor" href="#_1-5-tp-sp-vs-cp-vs-ep" aria-hidden="true">#</a> 1.5. TP &amp; SP vs CP vs EP</h3><figure><img src="/blog/assets/027_tpsp_cp_ep-ML1IozvN.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_1-6-æ¯ç§å¹¶è¡Œç­–ç•¥èŠ‚çº¦å†…å­˜çš„å¯¹æ¯”" tabindex="-1"><a class="header-anchor" href="#_1-6-æ¯ç§å¹¶è¡Œç­–ç•¥èŠ‚çº¦å†…å­˜çš„å¯¹æ¯”" aria-hidden="true">#</a> 1.6. æ¯ç§å¹¶è¡Œç­–ç•¥èŠ‚çº¦å†…å­˜çš„å¯¹æ¯”</h3><figure><img src="/blog/assets/027_memory_usage_comparation-PiBc-0JK.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="/blog/assets/027_memory_savings-tjqnAD0r.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="_2-æœ€ä½³è®­ç»ƒé…ç½®" tabindex="-1"><a class="header-anchor" href="#_2-æœ€ä½³è®­ç»ƒé…ç½®" aria-hidden="true">#</a> 2. æœ€ä½³è®­ç»ƒé…ç½®</h2><p>è€ƒè™‘ç‚¹</p><ul><li>è€ƒè™‘åˆ°è®¡ç®—é›†ç¾¤çš„å„ç§ç‰©ç†å±æ€§ï¼Œç½‘ç»œå¸¦å®½ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„GPUæ•°ï¼Œæ¯ä¸ªGPUçš„æ˜¾å­˜å¤§å°</li><li>è€ƒè™‘æ¨¡å‹å¤§å°</li><li>è€ƒè™‘æ‰¹æ¬¡å¤§å°</li></ul><h3 id="_2-1-step1-fitting-a-training-step-in-memory-fit-a-full-model-instance-on-our-gpus" tabindex="-1"><a class="header-anchor" href="#_2-1-step1-fitting-a-training-step-in-memory-fit-a-full-model-instance-on-our-gpus" aria-hidden="true">#</a> 2.1. Step1: Fitting a Training Step in Memory / Fit a full model instance on our GPUs</h3><ul><li>GPUèµ„æºå¤š <ul><li>ä½äº10Bå‚æ•°çš„æ¨¡å‹ <ul><li>åœ¨8ä¸ªGPUä¸Šä½¿ç”¨å•ä¸€çš„å¹¶è¡Œç­–ç•¥ <ul><li>e.g. Tensor Parallelism or ZeRO-3/DP with Full Recompute across 8 GPUs</li></ul></li></ul></li><li>å‚æ•°åœ¨10B-100Bä¹‹é—´çš„æ¨¡å‹ <ul><li>åœ¨8ä¸ªGPUä¸Šä½¿ç”¨æ··åˆå¹¶è¡Œç­–ç•¥ <ul><li>TPï¼ˆTP=8ï¼‰+ PP</li><li>TPï¼ˆTP=8ï¼‰+ ZeRO-3</li><li>only ZeRO-3</li></ul></li></ul></li><li>åœ¨512ä¸ªä»¥ä¸Šçš„GPUè§„æ¨¡ä¸‹ <ul><li>ç”±äºé€šä¿¡æˆæœ¬ï¼Œçº¯æ•°æ®å¹¶è¡Œ/ZeRO-3ä¼šå¼€å§‹å˜å¾—ä½æ•ˆï¼Œæ­¤æ—¶æœ€å¥½å°†æ•°æ®å¹¶è¡Œä¸å¼ é‡å¹¶è¡Œæˆ–æµæ°´çº¿å¹¶è¡Œç»“åˆä½¿ç”¨</li></ul></li><li>åœ¨1024ä¸ªä»¥ä¸Šçš„GPUè§„æ¨¡ä¸‹ <ul><li>æ¨èçš„é…ç½®å¯ä»¥æ˜¯å¼ é‡å¹¶è¡Œï¼ˆTP=8ï¼‰ç»“åˆæ•°æ®å¹¶è¡Œï¼ˆZeRO-2ï¼‰å’Œæµæ°´çº¿å¹¶è¡Œ</li></ul></li><li>ç‰¹åˆ«è€ƒè™‘ <ul><li>å¯¹äºè¶…é•¿åºåˆ—ï¼šCC</li><li>å¯¹äºMoEæ¶æ„ï¼šEP</li></ul></li></ul></li><li>GPUèµ„æºå°‘ <ul><li>å®Œå…¨çš„æ¿€æ´»å€¼é‡æ–°è®¡ç®—ç”¨æ—¶é—´æ¢ç©ºé—´ (è®­ç»ƒæœ‰äº›ç¼“æ…¢)</li><li>å¢åŠ æ¢¯åº¦ç´¯ç§¯æ¥å¤„ç†æ›´å¤§çš„æ‰¹æ¬¡</li></ul></li></ul><h3 id="_2-2-step2-achieving-target-global-batch-size" tabindex="-1"><a class="header-anchor" href="#_2-2-step2-achieving-target-global-batch-size" aria-hidden="true">#</a> 2.2. Step2: Achieving Target Global Batch Size</h3><ul><li>å¢åŠ å½“å‰çš„å…¨å±€æ‰¹æ¬¡å¤§å° <ul><li>æ‰©å¤§ DP æˆ– æ¢¯åº¦ç´¯ç§¯æ­¥éª¤</li><li>å¯¹äºé•¿åºåˆ—ï¼Œé‡‡ç”¨ CP</li></ul></li><li>å‡å°‘å½“å‰çš„å…¨å±€æ‰¹æ¬¡å¤§å° <ul><li>å‡å°‘ DP</li><li>å¯¹äºé•¿åºåˆ—ï¼Œå‡å°‘ CP</li></ul></li></ul><h3 id="_2-3-step3-optimizing-training-throughput-make-sure-the-training-is-running-as-fast-as-possible" tabindex="-1"><a class="header-anchor" href="#_2-3-step3-optimizing-training-throughput-make-sure-the-training-is-running-as-fast-as-possible" aria-hidden="true">#</a> 2.3. Step3: Optimizing Training Throughput / make sure the training is running as fast as possible</h3><p>åœ¨å†…å­˜å’Œé€šä¿¡ä¸æ˜¯ç“¶é¢ˆçš„æƒ…å½¢ä¸‹ï¼Œå°è¯•ä»¥ä¸‹æ“ä½œï¼š</p><ul><li>æ‰©å¤§TPï¼Œä½¿ç”¨å¿«é€Ÿçš„èŠ‚ç‚¹å†…å¸¦å®½ï¼Œç›´åˆ°å¹¶è¡Œåº¦æ¥è¿‘èŠ‚ç‚¹å¤§å°ï¼Œä»è€Œå‡å°‘å…¶ä»–å¹¶è¡Œæ–¹å¼çš„ä½¿ç”¨</li><li>åœ¨ä¿æŒç›®æ ‡æ‰¹æ¬¡å¤§å°çš„åŒæ—¶ï¼Œå¢åŠ ä½¿ç”¨ZeRO-3çš„æ•°æ®å¹¶è¡Œ</li><li>å½“æ•°æ®å¹¶è¡Œçš„é€šä¿¡å¼€å§‹æˆä¸ºç“¶é¢ˆæ—¶ï¼Œè¿‡æ¸¡åˆ°ä½¿ç”¨æµæ°´çº¿å¹¶è¡Œ</li><li>å°è¯•é€ä¸€æ‰©å±•ä¸åŒçš„å¹¶è¡Œæ–¹å¼</li><li>å®éªŒå‡ ç§å¾®æ‰¹æ¬¡å¤§å°ï¼ˆmbsï¼‰ï¼Œä»¥åœ¨æœ€å¤§å…¨å±€æ‰¹æ¬¡å¤§å°ï¼ˆGBSï¼‰ã€æ¨¡å‹å¤§å°ã€è®¡ç®—å’Œé€šä¿¡ä¹‹é—´å¯»æ±‚æœ€ä½³å¹³è¡¡</li></ul><h3 id="_2-4-top-configurations" tabindex="-1"><a class="header-anchor" href="#_2-4-top-configurations" aria-hidden="true">#</a> 2.4. Top Configurations</h3><p>å›ºå®šçš„å®éªŒè®¾ç½®ï¼š sequence length: 4096 gbs(global batch size): 1M tokens</p><figure><img src="/blog/assets/027_best_configurations-o11yGyWp.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>å±•ç¤ºäº†ä¸åŒçš„æ¨¡å‹å¤§å°ï¼Œè®¡ç®—èŠ‚ç‚¹æ•°ï¼ˆæ¯ä¸ªèŠ‚ç‚¹æœ‰8ä¸ªGPUï¼‰çš„æœ€ä½³é…ç½®ï¼Œé¢œè‰²è¡¨ç¤ºäº†MFU (Model FLOPs Utilization)ï¼Œå…¶ä¸­FLOPs ä¸º Floating point operations per secondï¼Œè¶Šäº®çš„é¢œè‰²ä»£è¡¨æ›´é«˜çš„æ•ˆç‡</p><p>åŒ…å«çš„é…ç½®ç»†èŠ‚</p><ul><li>DP</li><li>TP</li><li>PP</li><li>GAS (Gradient Accumulation Steps)</li><li>MBS (Micro Batch Size)</li><li>ZeRO</li></ul><p>å¯è·å¾—çš„é‡è¦ä¿¡æ¯</p><ul><li>éšç€èŠ‚ç‚¹æ•°é‡çš„å¢åŠ ï¼ˆæ›´é«˜çš„å¹¶è¡Œåº¦ï¼‰ï¼Œæ•ˆç‡æœ‰æ‰€ä¸‹é™ï¼Œå¯¹å°æ¨¡å‹æ›´ä¸ºæ˜æ˜¾ï¼ˆè™½ç„¶å¯ä»¥é€šè¿‡å¢å¤§æ‰¹æ¬¡å¤§å°æ¥è¡¥å¿å°æ¨¡å‹çš„å°ºå¯¸ï¼Œä½†æˆ‘ä»¬å—åˆ°å…¨å±€æ‰¹æ¬¡å¤§å°é™åˆ¶100ä¸‡çš„çº¦æŸï¼‰</li><li>è¾ƒå¤§æ¨¡å‹å¸¦æ¥äº†ä¸åŒçš„æŒ‘æˆ˜ã€‚éšç€æ¨¡å‹å¤§å°çš„å¢åŠ ï¼Œå†…å­˜éœ€æ±‚å¤§å¹…å¢é•¿ã€‚è¿™åœ¨èŠ‚ç‚¹è¾ƒå°‘çš„æƒ…å†µä¸‹äº§ç”Ÿäº†ä¸¤ç§æƒ…æ™¯ï¼šè¦ä¹ˆæ¨¡å‹å®Œå…¨æ— æ³•åŒ¹é…å†…å­˜å¤§å°ï¼Œè¦ä¹ˆå‹‰å¼ºåŒ¹é…ä½†ç”±äºæ¥è¿‘GPUå†…å­˜é™åˆ¶è€Œè¿è¡Œæ•ˆç‡ä½ä¸‹ï¼ˆä¾‹å¦‚ï¼Œ80äº¿å‚æ•°æ¨¡å‹åœ¨4ä¸ªèŠ‚ç‚¹ä¸Šçš„è®­ç»ƒï¼‰</li><li>æ€§èƒ½åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºæ¯ç§å¹¶è¡Œç­–ç•¥çš„å…·ä½“å®ç°çš„è´¨é‡ï¼ˆå½“æˆ‘ä»¬é¦–æ¬¡å®ç°è¿™ä¸¤ç§å¹¶è¡Œç­–ç•¥æ—¶ï¼Œå¼ é‡å¹¶è¡Œï¼ˆTPï¼‰ä¼˜äºæµæ°´çº¿å¹¶è¡Œï¼ˆPPï¼‰ã€‚åœ¨ä¼˜åŒ–äº†æˆ‘ä»¬çš„PPä»£ç åï¼Œå®ƒæˆä¸ºäº†æ›´å¿«çš„é€‰æ‹©ã€‚ç°åœ¨æˆ‘ä»¬æ­£åœ¨æ”¹è¿›TPå®ç°ä¸­çš„é€šä¿¡é‡å ï¼Œé¢„è®¡å®ƒå°†é‡æ–°è·å¾—æ€§èƒ½é¢†å…ˆä¼˜åŠ¿ã€‚ï¼‰</li></ul><h2 id="_3-å¼ é‡å¹¶è¡Œ-tensor-parallelism-tp" tabindex="-1"><a class="header-anchor" href="#_3-å¼ é‡å¹¶è¡Œ-tensor-parallelism-tp" aria-hidden="true">#</a> 3. å¼ é‡å¹¶è¡Œ Tensor Parallelismï¼ˆTPï¼‰</h2><h3 id="_3-1-tpåŸç†" tabindex="-1"><a class="header-anchor" href="#_3-1-tpåŸç†" aria-hidden="true">#</a> 3.1. TPåŸç†</h3><ul><li>ZeRO å¯¹æ¨¡å‹çš„å‚æ•°ã€æ¢¯åº¦å’Œä¼˜åŒ–å™¨çŠ¶æ€è¿›è¡Œäº†åˆ†ç‰‡ï¼Œä½†ä¸€æ—¦æ¿€æ´»å€¼å†…å­˜è¶…å‡ºäº†æˆ‘ä»¬çš„å†…å­˜é¢„ç®—ï¼Œæˆ‘ä»¬å°±é‡åˆ°äº†é™åˆ¶ã€‚</li><li>è¿™æ—¶ï¼Œæˆ‘ä»¬å¼•å…¥å¼ é‡å¹¶è¡Œï¼ˆTensor Parallelism, TPï¼‰ï¼Œè¿™æ˜¯ä¸€ç§ä¸ä»…åˆ†ç‰‡æƒé‡ã€æ¢¯åº¦å’Œä¼˜åŒ–å™¨çŠ¶æ€ï¼Œè¿˜åˆ†ç‰‡æ¿€æ´»å€¼çš„æ–¹æ³•ï¼Œè€Œä¸”åœ¨è®¡ç®—ä¹‹å‰æ— éœ€å°†å®ƒä»¬å…¨éƒ¨èšé›†ï¼ˆgatherï¼‰ã€‚</li></ul><p>TPçš„åŸç†æ˜¯åˆ©ç”¨äº†çŸ©é˜µä¹˜æ³•çš„æ•°å­¦æ€§è´¨ï¼š</p><figure><img src="/blog/assets/027_matrix_math-tR8yvVYh.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æ¡ˆä¾‹ï¼šå¦‚ä½•å¯¹ä»¥ä¸‹çš„è®¡ç®—è¿›è¡ŒTP</p><figure><img src="/blog/assets/027_tp_example-yxpHhuav.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æ–¹æ¡ˆä¸€ï¼šåˆ—åˆ†ç‰‡ / column-wise sharding / column-linear</p><ul><li>å°† X è¿›è¡Œå¹¿æ’­ï¼šbroadcast</li><li>å°† W è¿›è¡Œåˆ—åˆ†ç‰‡</li><li>èšé›†å¾—åˆ° Yï¼šall-gather</li></ul><figure><img src="/blog/assets/027_tp_column_linear-dA3LCRhR.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æ–¹æ¡ˆäºŒï¼šè¡Œåˆ†ç‰‡ / row-wise sharding / row-linear</p><ul><li>å°† X è¿›è¡Œåˆ—åˆ†ç‰‡ï¼šscatter</li><li>å°† W è¿›è¡Œè¡Œåˆ†ç‰‡</li><li>æ±‚å’Œå¾—åˆ° Yï¼šall-reduce</li></ul><figure><img src="/blog/assets/027_tp_row_linear-DJPB9Iiy.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_3-2-transformerå—çš„tpåº”ç”¨" tabindex="-1"><a class="header-anchor" href="#_3-2-transformerå—çš„tpåº”ç”¨" aria-hidden="true">#</a> 3.2. Transformerå—çš„TPåº”ç”¨</h3><p>Transformerä¸¤ä¸ªä¸»è¦çš„å—ï¼š</p><ul><li>MLP / Feedforward layers</li><li>MHA / Multi-Head Attention</li></ul><h4 id="_3-2-1-mlpå—-åˆ—åˆ†ç‰‡-è¡Œåˆ†ç‰‡" tabindex="-1"><a class="header-anchor" href="#_3-2-1-mlpå—-åˆ—åˆ†ç‰‡-è¡Œåˆ†ç‰‡" aria-hidden="true">#</a> 3.2.1. MLPå—ï¼šåˆ—åˆ†ç‰‡ -&gt; è¡Œåˆ†ç‰‡</h4><figure><img src="/blog/assets/027_tp_mlp-Jryv6bBS.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="/blog/assets/027_tp_region_mlp-63_r0hn1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>å›¾ä¸­çš„all-reduceæ“ä½œæ˜¯å¿…è¦çš„ï¼Œä¸”ä¸èƒ½å’ŒGPUè®¡ç®—é‡å </li><li>TPç¡®å®æœ‰åŠ©äºå‡å°‘çŸ©é˜µä¹˜æ³•çš„æ¿€æ´»å€¼å†…å­˜ï¼Œä½†æˆ‘ä»¬ä»éœ€è¦èšé›†å®Œæ•´çš„æ¿€æ´»å€¼ç”¨äºLayerNormçš„è¿ç®—</li></ul><h4 id="_3-2-2-mhaå—" tabindex="-1"><a class="header-anchor" href="#_3-2-2-mhaå—" aria-hidden="true">#</a> 3.2.2. MHAå—ï¼š</h4><ul><li>Qã€Kã€VçŸ©é˜µï¼šç”¨åˆ—åˆ†ç‰‡ <ul><li>å¤šå¤´ï¼šå¤šå¤´æ³¨æ„åŠ›çš„æ¯ä¸ªå¤´æœ¬èº«æ˜¯å¹¶è¡Œçš„ï¼ŒTPæ­£å¥½åˆ©ç”¨è¿™ä¸€ç‰¹æ€§</li><li>MQA (Multi-Query Attention)ï¼šæ‰€æœ‰ Q å…±äº«ä¸€ç»„ K å’Œ V</li><li>GQA (Grouped-Query Attention)ï¼šå¤šä¸ª Q å…±äº«ä¸€ç»„ K å’Œ Vï¼ˆåˆ†ç»„å…±äº«ï¼‰</li><li>å¼ é‡å¹¶è¡Œçš„åˆ—åˆ†ç‰‡æ–¹å¼å¯¹ MQA å’Œ GQA åŒæ ·é€‚ç”¨ï¼Œå› ä¸º K å’Œ V çš„å…±äº«ç‰¹æ€§ä¸ä¼šå½±å“å¤´çš„ç‹¬ç«‹è®¡ç®—</li><li>é™åˆ¶æ¡ä»¶ <ul><li>TPåˆ†ç‰‡ä¸ªæ•°ä¸è¦è¶…è¿‡Q/K/Vå¤´çš„ä¸ªæ•°ï¼ˆå¦åˆ™ä¸èƒ½ç‹¬ç«‹çš„è®¡ç®—ï¼Œéœ€è¦é¢å¤–çš„é€šä¿¡æ“ä½œï¼‰</li><li>GQAåˆ†ç‰‡ä¸ªæ•°ä¸è¦è¶…è¿‡K/Vçš„å¤´æ•°ï¼ˆå¦åˆ™éœ€è¦å¤åˆ¶K/Vçš„å¤´æ¥ä¿æŒåŒæ­¥ï¼‰ï¼Œä¾‹å¦‚Llama-3 8Bæœ‰8ä¸ªK/Vå¤´ï¼Œæ‰€ä»¥TPåˆ†ç‰‡ä¸è¦è¶…è¿‡8</li></ul></li></ul></li><li>OçŸ©é˜µï¼šç”¨è¡Œåˆ†ç‰‡</li></ul><figure><img src="/blog/assets/027_tp_mha-dRkkvl3k.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_3-3-ç¼©æ”¾tpåˆ†ç‰‡å¤§å°å¯¹ååé‡å’Œå†…å­˜çš„å½±å“" tabindex="-1"><a class="header-anchor" href="#_3-3-ç¼©æ”¾tpåˆ†ç‰‡å¤§å°å¯¹ååé‡å’Œå†…å­˜çš„å½±å“" aria-hidden="true">#</a> 3.3. ç¼©æ”¾TPåˆ†ç‰‡å¤§å°å¯¹ååé‡å’Œå†…å­˜çš„å½±å“</h3><figure><img src="/blog/assets/027_tp_scale-wyNMkcli.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æƒè¡¡</p><ul><li>è®¡ç®—æ•ˆç‡ï¼šå¢åŠ çš„TPåˆ†ç‰‡å¤§å°ä½¿å¾—ååé‡é™ä½ï¼ˆTP=8åˆ°TP=16,æœ‰æ˜¾è‘—çš„ä¸‹é™ï¼ŒTP=16åˆ°TP=32,æœ‰æ›´é™¡çš„ä¸‹é™ï¼Œä¸‹é™ç¨‹åº¦éšç€TPçš„å‡é«˜è¶Šå‘ä¸¥é‡ï¼‰</li><li>å¯ç”¨å†…å­˜ï¼šå¢åŠ çš„TPåˆ†ç‰‡å¤§å°ä½¿å¾—å¯å¤„ç†æ›´å¤§çš„æ‰¹å¤§å°</li></ul><figure><img src="/blog/assets/027_tp_memory_usage-GKHC2Xky.png" alt="alt text" tabindex="0" loading="lazy"><figcaption>alt text</figcaption></figure><h2 id="_4-åºåˆ—å¹¶è¡Œ-sequence-parallelism-sp" tabindex="-1"><a class="header-anchor" href="#_4-åºåˆ—å¹¶è¡Œ-sequence-parallelism-sp" aria-hidden="true">#</a> 4. åºåˆ—å¹¶è¡Œ Sequence Parallelism (SP)</h2><ul><li>åºåˆ—å¹¶è¡Œï¼ˆSPï¼‰æ¶‰åŠå¯¹æ¨¡å‹ä¸­æœªè¢«å¼ é‡å¹¶è¡Œï¼ˆTensor Parallelism, TPï¼‰å¤„ç†çš„éƒ¨åˆ†ï¼ˆä¾‹å¦‚ Dropout å’Œ LayerNormï¼‰çš„æ¿€æ´»å€¼å’Œè®¡ç®—è¿›è¡Œåˆ†ç‰‡ï¼Œä½†åˆ†ç‰‡æ˜¯æ²¿ç€è¾“å…¥åºåˆ—ç»´åº¦ï¼ˆsequence dimensionï¼‰è¿›è¡Œçš„ï¼Œè€Œä¸æ˜¯æ²¿ç€éšè—ç»´åº¦ï¼ˆhidden dimensionï¼‰ã€‚</li><li>æ­¤å¤„çš„åºåˆ—å¹¶è¡Œä¸å¼ é‡å¹¶è¡Œç´§å¯†è€¦åˆï¼Œä¸»è¦åº”ç”¨äº Dropout å’Œ LayerNorm æ“ä½œï¼ˆFor example, LayerNorm needs the full hidden dimension to compute mean and varianceï¼‰</li><li>ç„¶è€Œï¼Œå½“æˆ‘ä»¬å¤„ç†æ›´é•¿çš„åºåˆ—æ—¶ï¼Œæ³¨æ„åŠ›è®¡ç®—ä¼šæˆä¸ºç“¶é¢ˆï¼Œè¿™æ—¶éœ€è¦å¼•å…¥ä¸€äº›æŠ€æœ¯ï¼Œä¾‹å¦‚ Ring-Attentionï¼Œè¿™äº›æŠ€æœ¯æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºåºåˆ—å¹¶è¡Œï¼Œä½†æˆ‘ä»¬å°†å®ƒä»¬ç§°ä¸ºä¸Šä¸‹æ–‡å¹¶è¡Œï¼ˆContext Parallelismï¼‰ï¼Œä»¥åŒºåˆ†è¿™ä¸¤ç§æ–¹æ³•ã€‚å› æ­¤ï¼Œæ¯æ¬¡çœ‹åˆ°â€œåºåˆ—å¹¶è¡Œâ€æ—¶ï¼Œè¯·è®°ä½å®ƒé€šå¸¸ä¸å¼ é‡å¹¶è¡Œä¸€èµ·ä½¿ç”¨ï¼ˆè€Œä¸Šä¸‹æ–‡å¹¶è¡Œå¯ä»¥ç‹¬ç«‹ä½¿ç”¨ï¼‰ã€‚</li></ul><h3 id="_4-1-tp-only-ä¸-tp-with-sp" tabindex="-1"><a class="header-anchor" href="#_4-1-tp-only-ä¸-tp-with-sp" aria-hidden="true">#</a> 4.1. TP Only ä¸ TP with SP</h3><figure><img src="/blog/assets/027_tp_vs_tpsp-h5t0OcUf.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="/blog/assets/027_tpsp-sPHKFuAf.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æœ¯è¯­</p><ul><li>b : batch_size æ‰¹å¤§å°ï¼ˆå¼ é‡çš„ç¬¬ä¸€ç»´åº¦ï¼‰</li><li>s : sequence_length åºåˆ—é•¿åº¦ï¼ˆå¼ é‡çš„ç¬¬äºŒç»´åº¦ï¼‰</li><li>h : hidden_state éšçŠ¶æ€ï¼ˆå¼ é‡çš„ç¬¬ä¸‰ç»´åº¦ï¼‰</li></ul><p>å¯¹æ¯” TP Only å’Œ TP with SPï¼š</p><ul><li>åºåˆ—å¹¶è¡Œæœ€å…³é”®çš„ä¼˜åŠ¿æ˜¯å‡å°‘çš„éœ€è¦å­˜å‚¨çš„æœ€å¤§æ¿€æ´»å€¼å¤§å° <ul><li>TP Onlyï¼šåœ¨å¤šä¸ªç‚¹éƒ½éœ€è¦å­˜å½¢çŠ¶ä¸º(b, s, h)çš„æ¿€æ´»å€¼ï¼Œæ¿€æ´»å€¼å¤§å°ä¸º b * s * h</li><li>TP with SPï¼šæ¿€æ´»å€¼å½¢çŠ¶è½¬ä¸º(b, s, h/k) æˆ– (b, s/k, h)ï¼Œæœ€å¤§æ¿€æ´»å€¼å¤§å°è¢«å‡å°ä¸º b * s * h / kï¼Œå…¶ä¸­kä¸ºå¹¶è¡Œæ•°</li></ul></li><li>ä¸¤è€…åœ¨å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­ä¸­çš„é€šä¿¡å¼€é”€éƒ½ä¸€æ · <ul><li>TP Onlyï¼šæ¯ä¸ªTransformerå—æœ‰2ä¸ªall-reduceæ“ä½œ</li><li>TP with SPï¼šæ¯ä¸ªTransformerå—æœ‰2ä¸ªall-gatheræ“ä½œå’Œ2ä¸ªreduce-scatteræ“ä½œï¼Œä½†ç”±äºall-reduce = reduce-scatter + all-gatherï¼Œæ‰€ä»¥ç›¸å½“äºæœ‰2ä¸ªall-reduceæ“ä½œï¼Œå’ŒTP Onlyä¸€è‡´</li></ul></li></ul><h4 id="_4-1-1-å·¦å›¾-tp-only" tabindex="-1"><a class="header-anchor" href="#_4-1-1-å·¦å›¾-tp-only" aria-hidden="true">#</a> 4.1.1. å·¦å›¾ï¼šTP Only</h4><ul><li>f ä¸ f* æ“ä½œ <ul><li>f æ“ä½œ <ul><li>å‰å‘ä¼ æ’­ä¸­æ˜¯ç©ºæ“ä½œ</li><li>åå‘ä¼ æ’­ä¸­æ˜¯all-reduceæ“ä½œ</li></ul></li><li>f* æ“ä½œ <ul><li>å‰å‘ä¼ æ’­ä¸­æ˜¯all-reduceæ“ä½œ</li><li>åå‘ä¼ æ’­ä¸­æ˜¯ç©ºæ“ä½œ</li></ul></li></ul></li><li>æ•´ä½“çš„å¼ é‡å˜åŒ– <ul><li>(b, s, h) -&gt; Full</li><li>f</li><li>(b, s, h/k) -&gt; TP (åˆ—åˆ†ç‰‡ -&gt; è¡Œåˆ†ç‰‡)</li><li>f*</li><li>(b, s, h) -&gt; Full</li><li>f</li><li>(b, s, h/k) -&gt; TP (åˆ—åˆ†ç‰‡ -&gt; è¡Œåˆ†ç‰‡)</li><li>f*</li><li>(b, s, h) -&gt; Full</li></ul></li></ul><h4 id="_4-1-2-å³å›¾-tp-with-sp" tabindex="-1"><a class="header-anchor" href="#_4-1-2-å³å›¾-tp-with-sp" aria-hidden="true">#</a> 4.1.2. å³å›¾ï¼šTP with SP</h4><ul><li>g ä¸ g* æ“ä½œ <ul><li>g æ“ä½œ <ul><li>å‰å‘ä¼ æ’­ä¸­æ˜¯all-gatheræ“ä½œ</li><li>åå‘ä¼ æ’­ä¸­æ˜¯reduce-scatteræ“ä½œ</li></ul></li><li>g* æ“ä½œ <ul><li>å‰å‘ä¼ æ’­ä¸­æ˜¯reduce-scatteræ“ä½œ</li><li>åå‘ä¼ æ’­ä¸­æ˜¯all-gatheræ“ä½œ</li></ul></li></ul></li><li>æ•´ä½“çš„å¼ é‡å˜åŒ– <ul><li>(b, s/k, h) -&gt; SP</li><li>g</li><li>(b, s, h/k) -&gt; TP (åˆ—åˆ†ç‰‡ -&gt; è¡Œåˆ†ç‰‡)</li><li>g*</li><li>(b, s/k, h) -&gt; SP</li><li>g</li><li>(b, s, h/k) -&gt; TP (åˆ—åˆ†ç‰‡ -&gt; è¡Œåˆ†ç‰‡)</li><li>g*</li><li>(b, s/k, h) -&gt; SP</li></ul></li></ul><h3 id="_4-2-ååé‡å’Œå†…å­˜å ç”¨" tabindex="-1"><a class="header-anchor" href="#_4-2-ååé‡å’Œå†…å­˜å ç”¨" aria-hidden="true">#</a> 4.2. ååé‡å’Œå†…å­˜å ç”¨</h3><p>TP with SP çš„ MLP éƒ¨åˆ†æƒ…å†µï¼š</p><ul><li>ä¸TP Onlyä¸€æ ·ï¼ŒGPUé€šä¿¡ä¸èƒ½ä¸GPUè®¡ç®—é‡å ï¼Œè¿™ä½¿å¾—ååé‡ä¸¥é‡ä¾èµ–äºé€šä¿¡å¸¦å®½</li></ul><figure><img src="/blog/assets/027_tpsp1--MM33BKQ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>70Bæ¨¡å‹çš„å†…å­˜å ç”¨ï¼š</p><figure><img src="/blog/assets/027_tp_memory_usage1-nZZfQ95H.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>3B model with 4096 seqlen çš„ TP with SP ç¼©æ”¾å¯¹ååé‡å’Œå†…å­˜åˆ©ç”¨çš„å½±å“ï¼š</p><figure><img src="/blog/assets/027_tp_scale1-SYIrodxv.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>åŒæ ·éœ€è¦æƒè¡¡ååé‡å’Œå†…å­˜å ç”¨</p><h2 id="_5-context-parallelism-cp" tabindex="-1"><a class="header-anchor" href="#_5-context-parallelism-cp" aria-hidden="true">#</a> 5. Context Parallelism (CP)</h2><figure><img src="/blog/assets/027_cp-NFE-Vz8g.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_5-1-ring-attention-ç¯å½¢æ³¨æ„åŠ›" tabindex="-1"><a class="header-anchor" href="#_5-1-ring-attention-ç¯å½¢æ³¨æ„åŠ›" aria-hidden="true">#</a> 5.1. Ring Attention ç¯å½¢æ³¨æ„åŠ›</h3><figure><img src="/blog/assets/027_ring_attention-otkVRj8M.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>åœ¨æ¯ä¸ªæ—¶é—´æ­¥ï¼Œæ¯ä¸ªGPUæ¥è¿ç€æ‰§è¡Œè¿™ä¸‰ä¸ªæ“ä½œï¼š</p><ul><li>1.å‘é€å½“å‰çš„Kã€Våˆ°ä¸‹ä¸€ä¸ªGPU</li><li>2.æœ¬åœ°è®¡ç®—æ³¨æ„åŠ›å¾—åˆ†</li><li>3.ç­‰å¾…æ¥æ”¶ä¸Šä¸€ä¸ªGPUä¼ æ¥çš„Kã€V</li></ul><p>æœ´ç´ å®ç°å­˜åœ¨çš„é—®é¢˜ï¼šå› ä¸ºæœ‰æ©ç ï¼Œæ‰€ä»¥æ•°æ®å‘ˆä¸‹ä¸‰è§’ï¼Œè€ŒSoftmaxæ˜¯æŒ‰è¡Œè®¡ç®—çš„ï¼Œå„ä¸ªGPUä¸Šçš„è®¡ç®—æ˜¯ä¸å¹³è¡¡çš„</p><figure><img src="/blog/assets/027_causal_attention_mask-KR45d9ve.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_5-2-zig-zag-ring-attention" tabindex="-1"><a class="header-anchor" href="#_5-2-zig-zag-ring-attention" aria-hidden="true">#</a> 5.2. Zig-Zag Ring Attention</h3><p>å¹³è¡¡è®¡ç®—çš„å®ç°ï¼šä¸çº¯ç²¹æŒ‰é¡ºåºåˆ†é…ï¼ŒäºŒæŠŠå‰é¢çš„åé¢çš„tokenè¿›è¡Œæ··åˆåˆ°ä¸€ä¸ªGPUä¸Š</p><figure><img src="/blog/assets/027_zig_zag-G0Bvq0Ek.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ä¸¤ç§é‡å è®¡ç®—å’Œé€šä¿¡çš„æ–¹å¼</p><ul><li>all-gatherå®ç°ï¼šé‡ç»„æ‰€æœ‰çš„KVåœ¨æ¯ä¸ªGPUä¸Šï¼ˆä»¥ZeRO-3çš„æ–¹å¼ï¼‰ <ul><li>éœ€è¦ä¸´æ—¶å­˜å‚¨æ‰€æœ‰çš„KVå¯¹</li><li>é€šä¿¡åªå‘ç”Ÿåœ¨ç¬¬ä¸€æ­¥</li></ul></li><li>all-to-all(Ring)å®ç°ï¼šç¯å½¢ä¾æ¬¡æ”¶é›†æ¯ä¸ªGPUä¸Šçš„KV <ul><li>åªéœ€è¦ä¸´æ—¶å­˜å‚¨é¢å¤–çš„ä¸€å—</li><li>é€šä¿¡ä»å¤´åˆ°å°¾ï¼Œå’Œè®¡ç®—é‡å ï¼Œæœ‰ä¸€äº›å»¶è¿Ÿå¼€é”€</li></ul></li></ul><figure><img src="/blog/assets/027_cp_allgather-Tz_Ypeyk.png" alt="all-gatherå®ç°" tabindex="0" loading="lazy"><figcaption>all-gatherå®ç°</figcaption></figure><figure><img src="/blog/assets/027_cp_alltoall-ioER_nRf.png" alt="all-to-all(Ring)å®ç°" tabindex="0" loading="lazy"><figcaption>all-to-all(Ring)å®ç°</figcaption></figure><h2 id="_6-æµæ°´çº¿å¹¶è¡Œ-pipeline-parallelism-pp" tabindex="-1"><a class="header-anchor" href="#_6-æµæ°´çº¿å¹¶è¡Œ-pipeline-parallelism-pp" aria-hidden="true">#</a> 6. æµæ°´çº¿å¹¶è¡Œ Pipeline Parallelism (PP)</h2><p>æµæ°´çº¿å¹¶è¡Œï¼šæŠŠæ¨¡å‹çš„å±‚åˆ†åˆ°å¤šä¸ªGPUä¸Šï¼Œåˆè¢«ç§°ä¸ºâ€œå±‚é—´å¹¶è¡Œâ€</p><h3 id="_6-1-å†…å­˜å ç”¨" tabindex="-1"><a class="header-anchor" href="#_6-1-å†…å­˜å ç”¨" aria-hidden="true">#</a> 6.1. å†…å­˜å ç”¨</h3><figure><img src="/blog/assets/027_pp_memory_usage-WZGB_6dC.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æ¯ä¸ªGPUä»éœ€å¤„ç†è¿™æ‰¹æ¬¡çš„å…¨éƒ¨æ•°æ®ï¼Œåªæ˜¯åœ¨ä¸åŒçš„å±‚ä¸Šï¼Œæ‰€ä»¥æ¿€æ´»å€¼å å†…å­˜å¤§å°æ˜¯å®Œæ•´çš„ï¼Œæ¿€æ´»å€¼åœ¨ä¸€ä¸ªGPUçš„å±‚ä¸Šå¤„ç†å®Œåè¢«å‘é€ç»™ä¸‹ä¸€ä¸ªGPUï¼Œä»è€Œç»§ç»­å‰å‘ä¼ æ’­</p><h3 id="_6-2-ä¸»è¦æŒ‘æˆ˜-å°½é‡é¿å…gpuè®¡ç®—çš„é—²ç½®-æé«˜gpuåˆ©ç”¨ç‡" tabindex="-1"><a class="header-anchor" href="#_6-2-ä¸»è¦æŒ‘æˆ˜-å°½é‡é¿å…gpuè®¡ç®—çš„é—²ç½®-æé«˜gpuåˆ©ç”¨ç‡" aria-hidden="true">#</a> 6.2. ä¸»è¦æŒ‘æˆ˜ï¼šå°½é‡é¿å…GPUè®¡ç®—çš„é—²ç½®ï¼Œæé«˜GPUåˆ©ç”¨ç‡</h3><p>æ¡ˆä¾‹ï¼š16å±‚çš„æ¨¡å‹åˆ†å¸ƒåœ¨4ä¸ªGPUä¸Š</p><ul><li>t<sub>f</sub> : å‰å‘ä¼ æ’­çš„è€—æ—¶</li><li>t<sub>b</sub> : åå‘ä¼ æ’­çš„è€—æ—¶</li><li>ä¸€ä¸ªç®€å•çš„å‡è®¾ï¼št<sub>b</sub> = 2 * t<sub>f</sub></li></ul><h3 id="_6-3-æœ´ç´ pp" tabindex="-1"><a class="header-anchor" href="#_6-3-æœ´ç´ pp" aria-hidden="true">#</a> 6.3. æœ´ç´ PP</h3><ul><li>ç†æƒ³æ€»è€—æ—¶ï¼št<sub>ideal</sub> = t<sub>f</sub> + t<sub>b</sub></li><li>é—²ç½®æ—¶é—´ï¼št<sub>pipeline_bubble</sub> = (p - 1) * (t<sub>f</sub> + t<sub>b</sub>)ï¼Œå…¶ä¸­pä¸ºå¹¶è¡Œæ•°</li><li>é—²ç½®æ—¶é—´ä¸ç†æƒ³æ—¶é—´çš„æ¯”ä¾‹ï¼šr<sub>bubble</sub> = (p - 1) * (t<sub>f</sub> + t<sub>b</sub>) / (t<sub>f</sub> + t<sub>b</sub>) = p - 1</li></ul><figure><img src="/blog/assets/027_naive_pp-TioArJ31.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_6-4-all-forward-all-backward-afab-æ–¹æ¡ˆ-forward-then-backword-f-then-b" tabindex="-1"><a class="header-anchor" href="#_6-4-all-forward-all-backward-afab-æ–¹æ¡ˆ-forward-then-backword-f-then-b" aria-hidden="true">#</a> 6.4. all-forward-all-backward (AFAB) æ–¹æ¡ˆ / forward then backword / F then B</h3><ul><li>æŠŠæ‰¹æ¬¡å†åˆ†ä¸ºå¾®æ‰¹æ¬¡ï¼Œå›¾ä¸­æ–¹å—ä¸­çš„ç¼–å·å°±æ˜¯å¾®æ‰¹æ¬¡</li><li>æ¯æ‰¹æ¬¡è¢«åˆ’åˆ†ä¸º8ä¸ªå¾®æ‰¹æ¬¡ï¼Œ9-16ç¼–å·æ˜¯ä¸‹ä¸€ä¸ªæ‰¹æ¬¡çš„å¾®æ‰¹æ¬¡</li><li>å‡è®¾æ¨¡å‹æœ‰4å±‚ï¼Œæ¯ä¸ªGPUä¸Šæ”¾ä¸€å±‚</li><li>AFABæ˜¯æŒ‡ç­‰æ¯ä¸ªæ‰¹æ¬¡çš„æ‰€æœ‰å¾®æ‰¹æ¬¡çš„å‰å‘ä¼ æ’­éƒ½å®Œæˆåï¼Œå¼€å¯è¿™ä¸ªæ‰¹æ¬¡æ‰€æœ‰å¾®æ‰¹æ¬¡çš„åå‘ä¼ æ’­</li></ul><figure><img src="/blog/assets/027_pp_afab-fYB9xx0E.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>å­˜åœ¨çš„é—®é¢˜ï¼šè¦å­˜æ‰€æœ‰æ¿€æ´»å€¼ï¼ˆåªæœ‰ç­‰å‰å‘ä¼ æ’­éƒ½å®Œæˆäº†ï¼Œä¸”è¯¥å¾®æ‰¹æ¬¡çš„åå‘ä¼ æ’­å®Œæˆåæ‰èƒ½é‡Šæ”¾è¯¥å¾®æ‰¹æ¬¡çš„æ¿€æ´»å€¼ï¼‰</p><h3 id="_6-5-one-forward-one-backward-1f1b-and-llama-3-1-schemes-æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#_6-5-one-forward-one-backward-1f1b-and-llama-3-1-schemes-æ–¹æ¡ˆ" aria-hidden="true">#</a> 6.5. One-forward-one-backward (1F1B) and LLama 3.1 schemes æ–¹æ¡ˆ</h3><h4 id="_6-5-1-non-interleaved-schedule-éäº¤é”™è°ƒåº¦-é»˜è®¤æ˜¯æ­¤" tabindex="-1"><a class="header-anchor" href="#_6-5-1-non-interleaved-schedule-éäº¤é”™è°ƒåº¦-é»˜è®¤æ˜¯æ­¤" aria-hidden="true">#</a> 6.5.1. non-interleaved schedule éäº¤é”™è°ƒåº¦ ï¼ˆé»˜è®¤æ˜¯æ­¤ï¼‰</h4><ul><li>å’ŒAFABç›¸æ¯”ï¼Œåªè¦æœ‰ä¸€ä¸ªå¾®æ‰¹æ¬¡çš„å‰å‘ä¼ æ’­å®Œæˆäº†ï¼Œå°±å¼€å¯è¿™ä¸ªå¾®æ‰¹æ¬¡çš„åå‘ä¼ æ’­</li><li>æ¯ä¸ªå¾®æ‰¹æ¬¡å’Œå…¶ä»–å¾®æ‰¹æ¬¡ä¸è¿›è¡ŒåŒæ­¥</li><li>éäº¤é”™å¼è°ƒåº¦å¯åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µã€‚ç¬¬ä¸€é˜¶æ®µæ˜¯çƒ­èº«é˜¶æ®µï¼Œå¤„ç†å™¨è¿›è¡Œä¸åŒæ•°é‡çš„å‰å‘è®¡ç®—ã€‚åœ¨æ¥ä¸‹æ¥çš„é˜¶æ®µï¼Œå¤„ç†å™¨è¿›è¡Œä¸€æ¬¡å‰å‘è®¡ç®—ï¼Œç„¶åæ˜¯ä¸€æ¬¡åå‘è®¡ç®—ã€‚æœ€åä¸€ä¸ªé˜¶æ®µå¤„ç†å™¨å®Œæˆåå‘è®¡ç®—ã€‚</li></ul><figure><img src="/blog/assets/027_pp_1f1b-g3lBcSw9.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>åªå­˜éƒ¨åˆ†æ¿€æ´»å€¼ï¼ˆåªè¦è¯¥å¾®æ‰¹æ¬¡è‡ªå·±çš„å‰å‘ä¼ æ’­å®Œæˆï¼Œå°±å¯å¼€å¯è¯¥å¾®æ‰¹æ¬¡çš„åå‘ä¼ æ’­æ¥é‡Šæ”¾æ¿€æ´»å€¼ï¼Œæ­¤æ—¶å…¶ä»–å¾®æ‰¹æ¬¡çš„å‰å‘ä¼ æ’­è¿˜åœ¨è¿›è¡Œï¼‰</li><li>1F1Bæ”¹å–„äº†å†…å­˜å ç”¨ä½†æ²¡æœ‰æ”¹å–„é—²ç½®é—®é¢˜</li></ul><h4 id="_6-5-2-interleaving-stages-interleaved-schedule-äº¤é”™å¼è°ƒåº¦" tabindex="-1"><a class="header-anchor" href="#_6-5-2-interleaving-stages-interleaved-schedule-äº¤é”™å¼è°ƒåº¦" aria-hidden="true">#</a> 6.5.2. Interleaving stages / interleaved schedule äº¤é”™å¼è°ƒåº¦</h4><p>Transformerä¸¤ä¸ªä¸»è¦çš„å—ï¼š</p><ul><li>MLP / Feedforward layers</li><li>MHA / Multi-Head Attention</li></ul><p>è¿™é‡Œçš„æ¯ä¸ªå—ä»£è¡¨ä¸€ä¸ªè®¡ç®—å—ï¼Œç»¿è‰²å—ä»£è¡¨æ³¨æ„åŠ›å—MHAçš„å‰å‘ä¼ æ’­ï¼Œé’è‰²å—ä»£è¡¨å‰é¦ˆç¥ç»ç½‘ç»œMLPçš„å‰å‘ä¼ æ’­ï¼Œç²‰è‰²å—ä»£è¡¨MHAçš„åå‘ä¼ æ’­ï¼Œç´«è‰²å—ä»£è¡¨MLPçš„åå‘ä¼ æ’­ï¼Œå—ä¸Šçš„æ•°å­—è¡¨ç¤ºå¾®æ‰¹æ¬¡ID</p><figure><img src="/blog/assets/027_pp_interleaved_schedule-1UoE05Xj.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="_7-expert-parallelism-ep" tabindex="-1"><a class="header-anchor" href="#_7-expert-parallelism-ep" aria-hidden="true">#</a> 7. Expert Parallelism (EP)</h2><p>MoE(Mixture-of-Experts)åŸºç¡€: https://huggingface.co/blog/moe</p><figure><img src="/blog/assets/027_ep-WUyOgdDw.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Expert Parallelism (EP)ï¼šåœ¨ä¸“å®¶ç»´åº¦ä¸Šå¹¶è¡Œ</p><ul><li>æ¯ä¸ªä¸“å®¶çš„FFN Layeræ˜¯å®Œå…¨ç‹¬ç«‹çš„</li><li>æ¯”èµ·TPæ›´è½»é‡çº§ï¼Œå› ä¸ºä¸éœ€è¦åˆ‡åˆ†çŸ©é˜µä¹˜æ³•ï¼Œåªéœ€è¦è·¯ç”±hidden statesåˆ°æ­£ç¡®çš„ä¸“å®¶</li><li>ä¸€èˆ¬æ¯äºå…¶ä»–å¹¶è¡Œç­–ç•¥ä¸€èµ·é‡‡ç”¨ï¼Œå¦‚DP</li></ul><figure><img src="/blog/assets/027_ep1-cGtqi5ny.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="/blog/assets/027_ep2-YcQYADC8.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></div><!--[--><!----><!--]--><footer class="page-meta"><!----><div class="meta-item git-info"><!----><!----></div></footer><nav class="vp-page-nav"><a aria-label="åˆ†å¸ƒå¼è®­ç»ƒä¹‹äº”ï¼šGPUå…¥é—¨" class="vp-link nav-link prev nav-link prev" href="/blog/zh/posts/llm/028_distribution_and_parallelism_4.html"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="font-icon icon fa-fw fa-sm fas fa-lightbulb" style=""></span>åˆ†å¸ƒå¼è®­ç»ƒä¹‹äº”ï¼šGPUå…¥é—¨</div></a><a aria-label="åˆ†å¸ƒå¼è®­ç»ƒä¹‹ä¸‰ï¼šæ•°æ®å¹¶è¡Œ Data Parallelism" class="vp-link nav-link next nav-link next" href="/blog/zh/posts/llm/026_distribution_and_parallelism_2.html"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">åˆ†å¸ƒå¼è®­ç»ƒä¹‹ä¸‰ï¼šæ•°æ®å¹¶è¡Œ Data Parallelism<span class="font-icon icon fa-fw fa-sm fas fa-lightbulb" style=""></span></div></a></nav><!----><!--[--><!----><!--]--><!--]--></main><!--]--><!----></div><!--]--><!--]--><!----><!--]--></div>
    <script type="module" src="/blog/assets/app-74fYY7Rf.js" defer></script>
  </body>
</html>
